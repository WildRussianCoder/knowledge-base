# Фрагментированный ввод-вывод

Это способ ввода-вывода, при котором отдельно взятый системный вызов позволяет записать вектор буферов из одного потока данных. Данный тип ввода-вывода получил такое название, поскольку данные в виде небольших фрагментов рассыпаны в векторе буферов, откуда программе приходится их собирать. Альтернативное название этого подхода - векторный ввод/вывод. Стандартные системные вызовы, применяемые для чтения и записи, обеспечивают *линейный ввод/вывод*.

Фрагментированный ввод-вывод имеет преимущества преред линейным:
* Более логичный принцип написания кода
* Эффективность
* Производительность
* Атомарность

## Системные вызовы readv() и writev()

Функция `readv()` считывает `count` сегментов из файлового дескриптора `fd` в буферы, описанные в `iov`:

    #include <sys/uio.h>

    ssize_t readv(int fd, const struct iovec* iov, int count);

Функция `writev()` записывет не более `count` сегментов из буферов, описанных в `iov`, в файловый дескриптор `fd`:

    #include <sys/uio.h>

    ssize_t writev(int fd, const struct iovec* iov, int count);

Каждая структура `iovec` описывает самостоятельный отдельный буфер, называемый *сегментом*:

    #include <sys/uio.h>

    struct iovec{
        void* iov_base; // указатель на начало буфера
        ssize_t iov_len; // размер буфера в байтах
    };

В случае успеха эти функции возвращают кол-во байт считанных или записанных. При ошибке - `-1` и `errno`.