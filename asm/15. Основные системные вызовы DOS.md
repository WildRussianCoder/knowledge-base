# Основные системные вызозы DOS (int 0x21)

## Немедленное завершение программы

Ввод:
* AH = 0x4C
* AL = Код возврата

## Вывод строки

Ввод: 
* AH = 0x09
* DS:DX = указатель на строку, завершенную "$"

## Вывод символа

Ввод:
* AH = 0x02
* DL = ASCII-код символа

## Чтение символа с экранированием

Ввод: 
* AH = 0x01

Вывод: 
* AL = прочитанный символ

## Чтение символа без экранирования

Ввод:
* AH = 0x08

Вывод
* AL = прочитанный символ

## Считывание строки

Ввод:
* AH = 0x0A
* DS:DX = указатель на буфер в специальном формате

Вывод:
* В буфере находится прочитанная строка

Примечание:   
Первый байт буфера содержит его максимальный размер, то есть кол-во символов (1-254), по достижении которого выдается звуковой сигнал (ASCII-код 7) и требуется нажать Enterю Следующий байт содержит фактическое количество введенных символов, не считая символа 0x0D (кода клавиши Enter).

## Открытие файла

Ввод:
* AH = 0x3D
* DS:DX = указатель на имя файла, завершенное нулевым байтом
* AL = режим доступа

Вывод: 
* CF = 0, если успешно, тогда
  * AX = дескриптор файла
* CF = 1, если ошибка, тогда 
  * AX = код ошибки

Режим доступа:
* 0 - чтение и запись
* 1 - только чтение
* 2 - только запись

Код ошибки: 
* 0x0002 - файл не найден
* 0x0003 - путь не найден

## Закрытие файла

Ввод:
AH = 0x3E
BX = дескриптор файла

Вывод:
* CF = 0, если успешно
* CF = 1, если успешно, тогда
  * AX = код ошибки

## Чтение из файла

Ввод:
* AH = 0x3F
* BX = дескриптор файла
* DS:DX = указатель на буфер
* CX = размер буфера

Вывод:
* CF = 0, если успешно, тогда
  * AX = кол-во прочитанных байт
* CF = 1, если ошибка, тогда
  * AX = код ошибки

## Запись в файл

Ввод:
* AH = 0x40
* BX = дескриптор файла
* DS:DX = указатель на буфер
* CX = размер порции

Вывод:
* CF = 0, если успешно, тогда
  * AX = кол-во записанных байтов
* CF = 1, если ошибка, тогда
  * AX = код ошибки

## Открытие/создание файла

Ввод:
* AH = 0x6C
* AL = 0x00
* BX = массив битов для расширенного режима
* CX = атрибуты для нового файла
* DX = массив битов для требуемой операции
* DS:DX = указатель на имя файла

Вывод: 
* CF = 0, успех
  * AX = дескриптор файла
  * CX = отчет об операции
* CF = 1, ошибка
  * AX = код ошибки

Требуемый режим мы можем указать в регистре DX. Можно использовать следующие комбинации битов при системном вызове

DL:
* 0000b - выйти с ошибкой, если файл существует
* 0001b - открыть файл, если он существует
* 0010b - открыть файл для перезаписи, если он существует

DH:
* 0000b - выйти с ошибкой, если файл не существует
* 0001b - создать файл, если он не существует

Атрибуты для нового файла:
* Бит 0 - только чтение
* Бит 1 - скрытый
* Бит 2 - системный
* Бит 3 - метка тома
* Бит 4 - каталог
* Бит 5 - архивный

Биты расширенного режима:
* 0 - только для чтения
* 1 - только для записи
* 2 - для чтения и записи

Отчет о выполненной операции: 
* 1 - файл был открыт
* 2 - файл был создан и открыт
* 3 - файл был перезаписан и открыт

## Поиск позиции в файле

Ввод: 
* AH = 0x42
* AL = начало отсчета
* BX = дескриптор
* CX:DX = смещение

Вывод: 
* CF = 0, успех
  * DX:AX = новая позиция
  * CX = отчет 
* CF = 1, ошибка
  * AX = код ошибки

Начало отсчета:
* 0 - от начала файла
* 1 - от текущей позиции
* 2 - от конца файла

## Удаление файла

Ввод:
* AH = 0x41
* DS:DX = указатель на имя файла

Вывод:
* CF = 0, успех
* CF = 1, ошибка

## Получение атрибутов

Ввод: 
* AH = 0x43
* AL = 0x00
* DS:DX = имя файла

Вывод: 
* CF = 0, успех
  * CX = атрибуты
* CF = 1, ошибка
  * AX = код ошибки

## Установка атрибутов

Ввод:
* AH = 0x43
* AL = 0x01
* CX = атрибуты
* DS:DX = имя файла

Вывод: 
* CF = 0, успех
  * CX = атрибуты
* CF = 1, ошибка
  * AX = код ошибки

## Переименование файла

Ввод: 
* AH = 0x56
* DS:DX = исходное имя файла
* ES:DI = новое имя файла

Вывод: 
* CF = 0, успех
* CF = 1, ошибка
  * AX = код ошибки

## Создание каталога

Ввод:
* AH = 0x39
* DS:DX = имя каталога

Вывод:
* CF = 0, успех
* CF = 1, ошибка

## Удаление каталога

Ввод:
* AH = 0x3A
* DS:DX = имя каталога

Вывод:
* CF = 0, успех
* CF = 1, ошибка

## Смена текущего каталога

Ввод: 
* AH = 0x3B
* DS:DX = имя каталога

Вывод:
* CF = 0
* CF = 1

## Получение текущего каталога

Ввод:
* AH = 0x47
* DL = номер диска (0 - текущий, 1 - A, 2 - B, ...)
* DS:SI = указатель на буфер для имени каталога

Вывод:
* CF = 0
* CF = 1

## Получить номер диска

Ввод: 
* AH = 0x19

Вывод: 
* AL = номер текущего диска (0 - A, 1 - B, ...)

## Установка текущего диска

Ввод:
* AH = 0x0E
* DL = номер диска (0 - A, 1 - B, ...)

Вывод:
* AL = кол-во имеющихся дисков
