# Основные команды

### Команда MOV

Копирует значение из источника в приемник:

    MOV источник, приемник
    
Несколько примеров:

    mov ax, [number]     ; заносим значение переменной number в AX
    mov [number], bx     ; загрузить регистр BX в переменную number
    mov bx, cx           ; В BX занести CX (CX -> BX)
    mov dh, cl           ; CL -> DH
    mov esi, edi         ; EDI -> ESI
    mov word [number], 1 ; Сохранить 16-битное значение 1 в переменную number

Некоторые правила:
* **Нельзя выполнять пересылки из памяти в память напрямую**
* **Оба операнда должны быть одного размера**

### Инструкции сложения и вычитания

    ADD o1, o2

Команда ADD складывает оба операнда и записывает результат в o1, предыдущее значение которого теряется. Точно так же работает команда вычитания - SUB:
    
    SUB o1, o2
    
Несколько примеров:

    mov ax, 8  ; AX = 8
    mov cx, 6  ; CX = 6
    mov dx, cx ; DX = CX
    add dx, ax ; DX += AX
    
    add eax, 8
    sub ecx, ebp
    add byte [number], 4
    sub word [number], 4
    add dword [number], 4
    sub byte [number], al
    sub ah, al
    
В случае переполнения устанавливается CF. Признак переноса используется в арифметических командах при работе с большими диапазонами чисел, чем могут поддерживать регистры. Полезны для этого команды ADC (Add With Carry - сложение с переносом) и SBB (Substract With Borrow - вычитание с займом): 

    ADC o1, o2 ; o1 += o2 + CF
    SBB o1, o2 ; o1 -= o2 - CF
    
В контексте арифметических операций часто используются пары регистров. Пара - это два регистра, использующихся для хранения одного числа. Часто используется пара EDX:EAX (или DX:AX) - обычно при умножении. Регистр AX хранит младшие 16 битов числа, а DX - старшие 16 битов. 

Пример: пара DX:AX содержит значение 0xFFFF (AX = 0xFFFF, DX = 0). Добавим 8 к этой паре и запишем результат обратно в DX:AX: 

    mov ax, 0xFFFF
    mov dx, 0
    add ax, 8
    adc dx, 0
    
### Команды инкремента и декремента

Эти команды увеличивают или уменьшают операнд на 1:

    INC o1 ; o1++
    DEC o1 ; o1--
    
**ВНИМАНИЕ! Ни одна из этих команд не изменяет флаг CF**

### Команды для работы с отрицательными числами

#### Команда NEG

Эта команда изменяет знак числа:

    NEG o1 ; o1 = -o1
    
Расширение диапазона целого числа делалось просто: мы просто копировали число в больший регистр, а расширенное "место" заполняли нулями. При работе с целыми числами со знаком мы должны заполнить это место старшим битом преобразуемого числа. Так мы можем сохранять положительные и отрицательные числа при расширении их диапазона. Расширение числа со знаком называется знаковым расширением.

#### Команда CBW

Команда CBW копирует седьмой (старший) бит регистра AL в регистр AH, расширяя таким образом оригинальное значение регистра AL в значение со знаком регистра AX (значение AH становится равно 0x00 или 0xFF, в зависимости от старшего бита AL).

    CBW ; Знаковое расширение AL => AX
    
#### Команда CWD

Команда CWD копирует старший бит AX в регистр DX, расширяя таким образом оригинальное значение AX в пару регистров со знаком DX:AX: 

    CWD
    
#### Команда CDQ

Команда CDQ копирует старший бит EAX в регистр EDX, расширяя таким образом оригинальное значение EAX в пару регистров со знаком EDX:EAX.

    CDQ
    
#### Команда CWDE

Команда CWDE копирует старший бит AX в верхнюю часть (старшую часть) EAX, расширяя таким образом оригинальное значение AX в двойное слово со знаком, которое будет помещено в регистр EAX.

    CWDE
    
### Целочисленное умножение и деление

Операции умножения и деления имеют свою специфику. В результате умножения и деления мы можем получить число, диапазон которого будетв два раза превышать диапазон операндов. Деление целых чисел - это операция целочисленная, поэтому в результате образуются два значения: частное и остаток. 

С целью упрощения реализации команд умножения и деления эти команды спроектированны так, то один из операндов и результат находятся в фиксированном регистре, а второй операнд указывается программистом. 

Для беззнаковых чисел существуют команды MUL и DIV. Для чисел со знаком - команды IMUL и IDIV.

#### Команды MUL и IMUL

Команда MUL может быть записана в трех различных форматах - в зависимости от операнда:

    MUL r/m8
    MUL r/m16
    MUL r/m32
    
В 8-разрядной форме операнд может быть любым регистром или адресом памяти. Второй операнд всегда хранится в AL. Результат (произведение) будет записан в регистр AX.

    AX = (r/m8) * AL
    
В 16-разрядной форме операнд может быть любым 16-битным регистром или адресом памяти. Второй операнд всегда хранится в AX. Результат сохраняется в паре DX:AX.

    DX:AX = (r/m16) * AX
    
В 32-разрядной форме второй операнд находится в регистре EAX, а результат записывается в пару EDX:EAX.

    EDX:EAX = (r/m32) * EAX

Команда IMUL умножает целые числа со знаком и может использовать один, два или три операнда. 

Если указан один операнд, то поведение IMUL будет таким же, как и команды MUL, просто она будет работать с числами со знаком.

Если указано два операнда, то команда IMUL умножит первый операнд на второй и сохранит результат в первом операнде, поэтому первый операнд всегда должен быть регистром. Втором операнд может быть регистром, непосредственным значением или адресом памяти.

Если указано три операнда, то команда IMUL перемножит второй и третий операнда, а результат созранит в первый операнд. Первый операнд - только регистр, второй может быть любого типа, а третий должен быть только непосредственным значением.

#### Команды DIV и IDIV

Подобно команде MUL, команда DIV может быть представлена в трех различных форматах:

    DIV r/m8  ; AX / (r/m8) -> AL, остаток -> AH
    DIV r/m16 ; DX:AX / (r/m16) -> AX, остаток -> DX
    DIV r/m32 ; EDX:EAX / (r/m32) -> EAX, остаток EDX
    
Операнд служит делителем, делимое находится в фиксированном месте.

Команда IDIV используется для деления чисел со знаком, синтаксис ее такой же, как у команды DIV.

### Побитовые команды

#### Команда AND

    AND o1, o1 ; o1 = o1 & o2
    
#### Команда OR

    OR o1, o2 ; o1 = o1 | o2
    
#### Команда XOR

    XOR o1, o2 ; o1 = o1 ^ o2
    
#### Команда NOT

    NOT o1 ; o1 = ~o1